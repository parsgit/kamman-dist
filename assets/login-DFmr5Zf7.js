import{_ as I,a as i}from"./MyInput-DUmkNkI1.js";import{l as P,m as T,b as c,r as s,S as x,P as B,o as r,c as d,g as l,w as C,a as t,t as w}from"./index-CEP-rUcO.js";const S={class:"flex justify-center pt-8"},$=t("div",null,[t("h2",{class:"text-center text-3xl font-bold text-primary"},"ورود ادمین")],-1),A={class:"flex flex-col gap-8 mt-12"},D={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-2 items-center"},N=["src"],V={key:1,class:"text-red-200 text-center"},j={class:"text-center"},q={__name:"login",setup(E){const k=P();T(()=>{c.token.length>4&&g(),f(),setInterval(()=>{n.value>0&&(n.value-=1,n.value==0&&f())},1e3)});const u=s(!1),p=s(""),v=s(""),n=s(0),m=s(""),h=s(""),_=s(""),f=()=>{x("captcha/check-ability",{},e=>{e.ok?(u.value=!0,v.value=c.server+"captcha/show?v="+new Date().getTime()):(p.value=e.message,n.value=e.diff)})},y=()=>{x("admin/auth",{username:m.value,password:h.value,captcha:_.value},e=>{e.ok?(c.setToken(e.auth_token),c.initToken(),g()):window.swal("",e.message,"warning")})},g=()=>{B("admin/check-auth",{},e=>{e.ok&&b()})},b=()=>{k.replace({name:"admin_panel"})};return(e,a)=>(r(),d("div",S,[l(I,{class:"border-2 border-primary shadow-xl shadow-secondary hover:shadow-secondary hover:shadow-lg duration-200"},{default:C(()=>[$,t("div",A,[l(i,{title:"نام کاربری",onInput:a[0]||(a[0]=o=>m.value=o),"input-class":"input-primary"}),l(i,{title:"رمزعبور",onInput:a[1]||(a[1]=o=>h.value=o),"input-class":"input input-primary",type:"password"}),u.value?(r(),d("div",D,[t("div",null,[l(i,{onInput:a[2]||(a[2]=o=>_.value=o),placeholder:"کد امنیتی",c:"primary"})]),t("div",null,[t("img",{class:"rounded-xl",src:v.value,alt:"captcha image"},null,8,N)])])):(r(),d("div",V,[t("div",null,w(p.value),1),t("div",null,w(n.value),1)])),t("div",j,[t("button",{onClick:a[3]||(a[3]=o=>y()),class:"btn btn-primary min-w-[200px] text-center"},"ورود")])])]),_:1})]))}};export{q as default};
